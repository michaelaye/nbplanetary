---

title: Config


keywords: fastai
sidebar: home_sidebar

summary: "This module manages configuration of the `planetarypy` package."
description: "This module manages configuration of the `planetarypy` package."
nb_path: "notebooks/00_config.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/00_config.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Config" class="doc_header"><code>class</code> <code>Config</code><a href="https://github.com/michaelaye/nbplanetary/tree/master/planetarypy/config.py#L16" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Config</code>(<strong><code>config_path</code></strong>:<code>str</code>=<em><code>None</code></em>)</p>
</blockquote>

<pre><code>Manage config stuff.

Attributes
-------
path: pathlib.Path

The key, value pairs found in the config file become attributes of the
class instance after initialization.
At minimum, there should be the `storage_root` attribute for storing data
for this package.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Manage config stuff.</span>

<span class="sd">    Attributes</span>
<span class="sd">    -------</span>
<span class="sd">    path: pathlib.Path</span>

<span class="sd">    The key, value pairs found in the config file become attributes of the</span>
<span class="sd">    class instance after initialization.</span>
<span class="sd">    At minimum, there should be the `storage_root` attribute for storing data</span>
<span class="sd">    for this package.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># This part enables a config path location override using env PYCISS_CONFIG</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;planetarypy_config.toml&quot;</span>
    <span class="c1"># separating fname from fpath so that resource_path below is correct.</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PLANETARYPY_CONFIG&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">config_path</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span>  <span class="c1"># str or pathlib.Path</span>
    <span class="p">):</span>
        <span class="s2">&quot;Switch to other config file location with `config_path`.&quot;</span>
        <span class="k">if</span> <span class="n">config_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">with</span> <span class="n">resource_path</span><span class="p">(</span><span class="s2">&quot;planetarypy.data&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_config</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_missions</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">read_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the configfile and store config dict.</span>

<span class="sd">        `storage_root` will be stored as attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tomldoc</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tomldoc</span><span class="p">[</span><span class="s2">&quot;storage_root&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ask_storage_root</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storage_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tomldoc</span><span class="p">[</span><span class="s2">&quot;storage_root&quot;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;get the Python dic from&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tomldoc</span>

    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span><span class="nb">str</span>  <span class="c1"># A nested key in dotted format, e.g. cassini.uvis.indexes</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get sub-dictionary by nested key.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;missions&#39;</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;missions.&#39;</span> <span class="o">+</span> <span class="n">key</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">toml</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">NonExistentKey</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nested_key</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>  <span class="c1"># A nested key in dotted format, e.g. cassini.uvis.ring_summary </span>
        <span class="n">value</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>  <span class="c1"># Value for the given key to be stored</span>
        <span class="n">save</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># Switch to control writing out to disk</span>
    <span class="p">):</span>
        <span class="s2">&quot;Set value in sub-dic using dotted key.&quot;</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tomldoc</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">nested_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">dic</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Write the TOML doc to file.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">toml</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tomldoc</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">ask_storage_root</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use input() to ask user for the storage_root path.</span>

<span class="sd">        The path will be stored in the TOML-dict and saved into existing config file</span>
<span class="sd">        at `Class.path`, either default or as given during init.</span>
<span class="sd">        `storage_root` attribute is set as well.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="s2">&quot;Provide the root storage path where all downloaded and produced data will be stored:&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tomldoc</span><span class="p">[</span><span class="s2">&quot;storage_root&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">missions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;missions&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">list_instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mission</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mission</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;missions&quot;</span><span class="p">):</span>
            <span class="n">mission</span> <span class="o">=</span> <span class="s2">&quot;missions.&quot;</span> <span class="o">+</span> <span class="n">mission</span>
        <span class="n">instruments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">mission</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">instruments</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">list_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instrument</span><span class="p">):</span>
        <span class="s2">&quot;instrument key needs to be &lt;mission&gt;.&lt;instrument&gt;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">instrument</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;missions&quot;</span><span class="p">):</span>
            <span class="n">instrument</span> <span class="o">=</span> <span class="s2">&quot;missions.&quot;</span> <span class="o">+</span> <span class="n">instrument</span>
        <span class="n">indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">instrument</span> <span class="o">+</span> <span class="s2">&quot;.indexes&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_copy_clean_to_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Copy a clean config file without timestamps into resource path for repo commit.&quot;</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tomldoc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">missions</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;missions&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">mission</span> <span class="ow">in</span> <span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">mdict</span> <span class="o">=</span> <span class="n">missions</span><span class="p">[</span><span class="n">mission</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">instr</span> <span class="ow">in</span> <span class="n">mdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">instrdict</span> <span class="o">=</span> <span class="n">mdict</span><span class="p">[</span><span class="n">instr</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">instrdict</span><span class="p">[</span><span class="s2">&quot;indexes&quot;</span><span class="p">]:</span>
                    <span class="n">instrdict</span><span class="p">[</span><span class="s2">&quot;indexes&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">with</span> <span class="n">resource_path</span><span class="p">(</span><span class="s2">&quot;planetarypy.data&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">Path</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">toml</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">dic</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">update_missions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Check if a new version with more URLs exist at resource path.&quot;</span>
        <span class="k">with</span> <span class="n">resource_path</span><span class="p">(</span><span class="s2">&quot;planetarypy.data&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">())[</span><span class="s2">&quot;missions&quot;</span><span class="p">]</span>
        <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tomldoc</span><span class="p">[</span><span class="s2">&quot;missions&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">mission</span> <span class="ow">in</span> <span class="n">new</span><span class="p">:</span>
            <span class="n">missiondata</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="n">mission</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">mission</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">old</span><span class="p">:</span>
                <span class="n">old</span><span class="p">[</span><span class="n">mission</span><span class="p">]</span> <span class="o">=</span> <span class="n">missiondata</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">instr</span> <span class="ow">in</span> <span class="n">missiondata</span><span class="p">:</span>
                <span class="n">instrdata</span> <span class="o">=</span> <span class="n">missiondata</span><span class="p">[</span><span class="n">instr</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">instr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">old</span><span class="p">[</span><span class="n">mission</span><span class="p">]:</span>
                    <span class="n">old</span><span class="p">[</span><span class="n">mission</span><span class="p">][</span><span class="n">instr</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrdata</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">instrdata</span><span class="p">[</span><span class="s2">&quot;indexes&quot;</span><span class="p">]:</span>
                    <span class="n">indexdata</span> <span class="o">=</span> <span class="n">instrdata</span><span class="p">[</span><span class="s2">&quot;indexes&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">old</span><span class="p">[</span><span class="n">mission</span><span class="p">][</span><span class="n">instr</span><span class="p">][</span><span class="s2">&quot;indexes&quot;</span><span class="p">]:</span>
                        <span class="n">old</span><span class="p">[</span><span class="n">mission</span><span class="p">][</span><span class="n">instr</span><span class="p">][</span><span class="s2">&quot;indexes&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">indexdata</span>
                        <span class="k">continue</span>
                    <span class="n">oldindexdata</span> <span class="o">=</span> <span class="n">old</span><span class="p">[</span><span class="n">mission</span><span class="p">][</span><span class="n">instr</span><span class="p">][</span><span class="s2">&quot;indexes&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">indexdata</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">oldindexdata</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]:</span>
                        <span class="n">oldindexdata</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indexdata</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">populate_timestamps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AttrDict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>- storage_root: /home/maye/big_drive/planetary_data
- missions: 
  - cassini: 
    - iss: 
      - indexes: 
        - index: 
          - url: https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_index.lbl
        - inventory: 
          - url: https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_inventory.lbl
        - moon_summary: 
          - url: https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_moon_summary.lbl
          - timestamp: 2021-07-23T22:11:38.904571
        - ring_summary: 
          - url: https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_ring_summary.lbl
          - timestamp: 2021-07-01T09:47:46.753035
        - saturn_summary: 
          - url: https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_saturn_summary.lbl
    - uvis: 
      - indexes: 
        - index: 
          - url: https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_index.lbl
        - moon_summary: 
          - url: https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_moon_summary.lbl
        - ring_summary: 
          - url: https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_ring_summary.lbl
        - saturn_summary: 
          - url: https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_saturn_summary.lbl
        - supplemental_index: 
          - url: https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_supplemental_index.lbl
        - versions: 
          - url: https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_versions.lbl
  - mro: 
    - hirise: 
      - indexes: 
        - dtm: 
          - url: https://hirise-pds.lpl.arizona.edu/PDS/INDEX/DTMCUMINDEX.LBL
        - edr: 
          - url: https://hirise-pds.lpl.arizona.edu/PDS/INDEX/EDRCUMINDEX.LBL
        - rdr: 
          - url: https://hirise-pds.lpl.arizona.edu/PDS/INDEX/RDRCUMINDEX.LBL
          - timestamp: 2021-07-27T23:02:51.210991
    - ctx: 
      - indexes: 
        - edr: 
          - url: 
          - timestamp: 2021-07-21T19:55:32.014076
  - lro: 
    - diviner: 
      - indexes: 
        - edr1: 
          - url: https://pds-geosciences.wustl.edu/lro/lro-l-dlre-2-edr-v1/lrodlr_0001/index/index.lbl
        - edr2: 
          - url: https://pds-geosciences.wustl.edu/lro/lro-l-dlre-2-edr-v1/lrodlr_0002/index/index.lbl
        - rdr1: 
          - url: https://pds-geosciences.wustl.edu/lro/lro-l-dlre-4-rdr-v1/lrodlr_1001/index/rdrindex.lbl
        - rdr2: 
          - url: https://pds-geosciences.wustl.edu/lro/lro-l-dlre-4-rdr-v1/lrodlr_1002/index/rdrindex.lbl
    - lola: 
      - indexes: 
        - edr: 
          - url: http://pds-geosciences.wustl.edu/lro/lro-l-lola-2-edr-v1/lrolol_0xxx/index/edrindex.lbl
        - rdr: 
          - url: http://pds-geosciences.wustl.edu/lro/lro-l-lola-3-rdr-v1/lrolol_1xxx/index/rdrindex.lbl
    - lroc: 
      - indexes: 
        - edr: 
          - url: http://pds.lroc.asu.edu/data/LRO-L-LROC-2-EDR-V1.0/LROLRC_0048C/INDEX/CUMINDEX.LBL</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">mission</span> <span class="ow">in</span> <span class="n">missions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">mdict</span> <span class="o">=</span> <span class="n">missions</span><span class="p">[</span><span class="n">mission</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">instr</span> <span class="ow">in</span> <span class="n">mdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">instrdict</span> <span class="o">=</span> <span class="n">mdict</span><span class="p">[</span><span class="n">instr</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">instrdict</span><span class="p">[</span><span class="s2">&quot;indexes&quot;</span><span class="p">]:</span>
            <span class="n">instrdict</span><span class="p">[</span><span class="s2">&quot;indexes&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">mission</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">list_missions</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">instrument</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">list_instruments</span><span class="p">(</span><span class="n">mission</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">list_indexes</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mission</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">instrument</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">):</span>
            <span class="c1">#             key = &quot;.&quot;.join([&#39;missions&#39;, mission, instrument, index])</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>index
inventory
moon_summary
ring_summary
saturn_summary
index
moon_summary
ring_summary
saturn_summary
supplemental_index
versions
dtm
edr
rdr
edr
edr1
edr2
rdr1
rdr2
edr
rdr
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Config()-object">The Config() object<a class="anchor-link" href="#The-Config()-object"> </a></h2><p>The <a href="/nbplanetary/config.html"><code>config</code></a> module instantiates a <a href="/nbplanetary/config.html"><code>config</code></a> object from the Config class.
Its attributes can be used to access several aspects relevant to the configuration of <code>planetarypy</code>.
Using an object approach enables easy growth and nesting over time.
{% include note.html content='Any cell that starts with an <code># export</code> becomes part of the library.' %}  Any other cells become automatically part of tests.
  <code>exports</code> also adds the exported code to the docs.
{% include note.html content='A good "First issue" for collaborators would be to improve the Config class to be able to merge a new larger index catalog with an existing one the user might have configured. This will need to take care of existing timestamps and possible other indexes that were put in by the user.' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;test_config.toml&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">storage_root</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path(&#39;/home/maye/big_drive/planetary_data&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">storage_root</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path(&#39;/home/maye/big_drive/planetary_data&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Config.read_config" class="doc_header"><code>Config.read_config</code><a href="https://github.com/michaelaye/nbplanetary/tree/master/planetarypy/config.py#L47" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Config.read_config</code>()</p>
</blockquote>

<pre><code>Read the configfile and store config dict.

`storage_root` will be stored as attribute.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Config.get_value" class="doc_header"><code>Config.get_value</code><a href="https://github.com/michaelaye/nbplanetary/tree/master/planetarypy/config.py#L63" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Config.get_value</code>(<strong><code>key</code></strong>:<code>str</code>)</p>
</blockquote>

<pre><code>Get sub-dictionary by nested key.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="s2">&quot;missions.cassini.iss.indexes.moon_summary&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_moon_summary.lbl&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Config.set_value" class="doc_header"><code>Config.set_value</code><a href="https://github.com/michaelaye/nbplanetary/tree/master/planetarypy/config.py#L75" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Config.set_value</code>(<strong><code>nested_key</code></strong>:<code>str</code>, <strong><code>value</code></strong>:<code>Union</code>[<code>float</code>, <code>str</code>], <strong><code>save</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>

<pre><code>Set value in sub-dic using dotted key.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Config.save" class="doc_header"><code>Config.save</code><a href="https://github.com/michaelaye/nbplanetary/tree/master/planetarypy/config.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Config.save</code>()</p>
</blockquote>

<pre><code>Write the TOML doc to file.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_moon_summary.lbl&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Config.ask_storage_root" class="doc_header"><code>Config.ask_storage_root</code><a href="https://github.com/michaelaye/nbplanetary/tree/master/planetarypy/config.py#L94" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Config.ask_storage_root</code>()</p>
</blockquote>

<pre><code>Use input() to ask user for the storage_root path.

The path will be stored in the TOML-dict and saved into existing config file
at `Class.path`, either default or as given during init.
`storage_root` attribute is set as well.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">missions</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;cassini&#39;, &#39;mro&#39;, &#39;lro&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">fname</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;planetarypy_config.toml&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">path</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path(&#39;/home/maye/.planetarypy_config.toml&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">list_instruments</span><span class="p">(</span><span class="s2">&quot;cassini&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;iss&#39;, &#39;uvis&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">list_indexes</span><span class="p">(</span><span class="s2">&quot;cassini.iss&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;index&#39;, &#39;inventory&#39;, &#39;moon_summary&#39;, &#39;ring_summary&#39;, &#39;saturn_summary&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">d</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;storage_root&#39;: &#39;/home/maye/big_drive/planetary_data&#39;, &#39;missions&#39;: {&#39;cassini&#39;: {&#39;iss&#39;: {&#39;indexes&#39;: {&#39;index&#39;: {&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_index.lbl&#39;}, &#39;inventory&#39;: {&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_inventory.lbl&#39;}, &#39;moon_summary&#39;: {&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_moon_summary.lbl&#39;}, &#39;ring_summary&#39;: {&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_ring_summary.lbl&#39;}, &#39;saturn_summary&#39;: {&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COISS_2xxx/COISS_2999/COISS_2999_saturn_summary.lbl&#39;}}}, &#39;uvis&#39;: {&#39;indexes&#39;: {&#39;index&#39;: {&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_index.lbl&#39;}, &#39;moon_summary&#39;: {&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_moon_summary.lbl&#39;}, &#39;ring_summary&#39;: {&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_ring_summary.lbl&#39;}, &#39;saturn_summary&#39;: {&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_saturn_summary.lbl&#39;}, &#39;supplemental_index&#39;: {&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_supplemental_index.lbl&#39;}, &#39;versions&#39;: {&#39;url&#39;: &#39;https://pds-rings.seti.org/holdings/metadata/COUVIS_0xxx/COUVIS_0999/COUVIS_0999_versions.lbl&#39;}}}}, &#39;mro&#39;: {&#39;hirise&#39;: {&#39;indexes&#39;: {&#39;dtm&#39;: {&#39;url&#39;: &#39;https://hirise-pds.lpl.arizona.edu/PDS/INDEX/DTMCUMINDEX.LBL&#39;}, &#39;edr&#39;: {&#39;url&#39;: &#39;https://hirise-pds.lpl.arizona.edu/PDS/INDEX/EDRCUMINDEX.LBL&#39;}, &#39;rdr&#39;: {&#39;url&#39;: &#39;https://hirise-pds.lpl.arizona.edu/PDS/INDEX/RDRCUMINDEX.LBL&#39;}}}, &#39;ctx&#39;: {&#39;indexes&#39;: {&#39;edr&#39;: {&#39;url&#39;: &#39;&#39;}}}}, &#39;lro&#39;: {&#39;diviner&#39;: {&#39;indexes&#39;: {&#39;edr1&#39;: {&#39;url&#39;: &#39;https://pds-geosciences.wustl.edu/lro/lro-l-dlre-2-edr-v1/lrodlr_0001/index/index.lbl&#39;}, &#39;edr2&#39;: {&#39;url&#39;: &#39;https://pds-geosciences.wustl.edu/lro/lro-l-dlre-2-edr-v1/lrodlr_0002/index/index.lbl&#39;}, &#39;rdr1&#39;: {&#39;url&#39;: &#39;https://pds-geosciences.wustl.edu/lro/lro-l-dlre-4-rdr-v1/lrodlr_1001/index/rdrindex.lbl&#39;}, &#39;rdr2&#39;: {&#39;url&#39;: &#39;https://pds-geosciences.wustl.edu/lro/lro-l-dlre-4-rdr-v1/lrodlr_1002/index/rdrindex.lbl&#39;}}}, &#39;lola&#39;: {&#39;indexes&#39;: {&#39;edr&#39;: {&#39;url&#39;: &#39;http://pds-geosciences.wustl.edu/lro/lro-l-lola-2-edr-v1/lrolol_0xxx/index/edrindex.lbl&#39;}, &#39;rdr&#39;: {&#39;url&#39;: &#39;http://pds-geosciences.wustl.edu/lro/lro-l-lola-3-rdr-v1/lrolol_1xxx/index/rdrindex.lbl&#39;}}}}}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

